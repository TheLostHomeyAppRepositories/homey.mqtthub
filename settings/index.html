<!doctype html>
<html>
<head>
    <!-- <link rel="stylesheet" type="text/css" href="../assets/styles.css" /> -->
    <link rel="stylesheet" type="text/css" href="settings.css" />

    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
    <script type="text/javascript" src="/manager/webserver/assets/js/jquery.js"></script>
    <!--<script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>-->

    <script type="text/javascript" src="../assets/vue.min.js" data-origin="settings"></script>
    <script type="text/javascript" src="settings.js" data-origin="settings"></script>
</head>
<body>
    <div id="app">
        <!-- <p data-i18n="settings.benefit" class="benefit">Turn your Homey into a Hub</p> -->

        <div class="rTable tabs">
            <div class="rTableRow">
                <div id="tabb1" class="tab tab-active" onclick="showTab(1)" data-i18n="tab1.title">Settings</div>
                <div id="tabb2" class="tab tab-inactive" onclick="showTab(2)" data-i18n="tab2.title">Devices</div>
                <div id="tabb3" class="tab tab-inactive" onclick="showTab(3)" data-i18n="tab3.title">Instructions</div>
                <div id="tabb4" class="tab tab-inactive" onclick="showTab(4, true)" data-i18n="tab4.title">Log</div>
            </div>
        </div>
        <!-- <div class="rTable tabs">
            <div class="rTableRow">
                <div id="tabb1" class="homey-button-secondary-shadow tab-active" onclick="showTab(1)" data-i18n="tab1.title">Settings</div>
                <div id="tabb2" class="homey-button-secondary-shadow tab-inactive" onclick="showTab(2)" data-i18n="tab2.title">Devices</div>
                <div id="tabb3" class="homey-button-secondary-shadow tab-inactive" onclick="showTab(3)" data-i18n="tab3.title">Instructions</div>
                <div id="tabb4" class="homey-button-secondary-shadow tab-inactive" onclick="showTab(4, true)" data-i18n="tab4.title">Log</div>
            </div>
        </div> -->

        <div class="tab-content">
            <!-- <div style="height:8px" class="panel"></div> -->
            <div id="tab1" class="panel">

                <!--GENERAL-->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.general">General</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <table style="table-layout: fixed; width: 100%;">
                        <tr>
                            <td style="width: 30%;">
                                <button class="homey-button-primary-shadow-full" id="startButton" @click="setRunning(true)" data-i18n="tab1.startButton">
                                    Start
                                </button>
                            </td>
                            <td style="width: 30%;">
                                <button class="homey-button-danger-shadow-full" id="stopButton" @click="setRunning(false)" data-i18n="tab1.stopButton"
                                    style="margin-left: 15px;">
                                    Stop
                                </button>
                            </td>
                            <td style="width: 40%;">
                                <label class="homey-form-checkbox" style="margin-left: 30px; pointer-events: none; opacity:0.5;">
                                    <input class="homey-form-checkbox-input" id="running" disabled="disabled" type="checkbox"/> <!-- v-model="running" @click="setRunning($event.target.checked)"/> -->
                                    <span class="homey-form-checkbox-checkmark"></span>
                                    <span class="homey-form-checkbox-text"><span data-i18n="tab1.running">Running</span></span>
                                </label>
                            </td>
                        </tr>
                    </table>
                    <!-- <legend class="homey-form-legend" ><span data-i18n="tab1.general">General</span></legend> -->
                    <label class="homey-form-label" for="refreshButton" data-i18n="tab1.refresh">Publish the state of all devices</label>
                    <button class="homey-button-secondary-shadow-full" id="refreshButton" @click="refresh()" data-i18n="tab1.broadcast">
                        Broadcast
                    </button>
                    <div id="progress"></div> 
                    <label class="homey-form-label" for="restartButton" data-i18n="tab1.restartLabel">Restart Hub incl. device broadcast</label>
                    <button class="homey-button-secondary-shadow-full" id="restartButton" @click="restart()" data-i18n="tab1.restartButton">
                        Restart Hub
                    </button>
                </fieldset>

                <!--SETTINGS -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.settings">Settings</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <button class="homey-button-primary-shadow-full" id="saveSettingsButton" onclick="saveSettings(true)" data-i18n="tab1.saveSettings">
                        Save settings
                    </button>
                    <label class="homey-form-label" for="protocol" data-i18n="tab1.refresh">Publish the state of all devices</label>
                    <select class="homey-form-select" id="protocol" @change="onInput()">
                        <option value="homie3" selected="selected">Homie Convention v3.0.1</option>
                        <option value="custom">Custom</option>
                    </select>
                </fieldset>

                <!--PROTOCOL Homie Convention-->
                <div id="homieSettings" style="display:none">
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title" data-i18n="tab1.protocolHeader">Homie Convention</h1>
                    </header>
                    <!-- <fieldset class="homey-form-fieldset"> -->
                        <!-- <legend class="homey-form-legend" ><span data-i18n="tab1.protocolHeader">Homie Convention</span></legend> -->
                        <label class="homey-form-label" for="homieTopic" data-i18n="tab1.topic">Topic</label>
                        <input class="homey-form-input" id="homieTopic" type="text"> <!--onblur="saveSettings(true)">-->
                    <!-- </fieldset> -->
                </div>

                <!--PROTOCOL Homie Convention-->
                <div id="customSettings" style="display:none">
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title" data-i18n="tab1.custom">CUSTOM</h1>
                    </header>
                    <!-- <fieldset class="homey-form-fieldset"> -->
                        <!-- <legend class="homey-form-legend" ><span data-i18n="tab1.custom">CUSTOM</span></legend> -->
                        <label class="homey-form-label" for="customTopic" data-i18n="tab1.topic">Topic</label>
                        <input class="homey-form-input" id="customTopic" type="text">  <!-- onblur="saveSettings(true)"> -->
                        <label class="homey-form-checkbox">
                            <input class="homey-form-checkbox-input" id="topicIncludeClass" type="checkbox"/> <!-- onclick="saveSettings(true)"/> -->
                            <span class="homey-form-checkbox-checkmark"></span>
                            <span class="homey-form-checkbox-text"><span data-i18n="tab1.topicIncludeClass">Include device class in topic</span></span>
                        </label>
                        <label class="homey-form-checkbox">
                            <input class="homey-form-checkbox-input" id="topicIncludeZone" type="checkbox"/> <!-- onclick="saveSettings(true)"/> -->
                            <span class="homey-form-checkbox-checkmark"></span>
                            <span class="homey-form-checkbox-text"><span data-i18n="tab1.topicIncludeZone">Include zone in topic</span></span>
                        </label>
                        <label class="homey-form-checkbox">
                            <input class="homey-form-checkbox-input" id="normalize" type="checkbox"/> <!-- onclick="saveSettings(true)"/> -->
                            <span class="homey-form-checkbox-checkmark"></span>
                            <span class="homey-form-checkbox-text"><span data-i18n="tab1.topicNormalize">Normalize topics (lowercase, remove characters, etc.)</span></span>
                        </label>
                        <label class="homey-form-checkbox">
                            <input class="homey-form-checkbox-input" id="broadcastDevices" type="checkbox"/> <!-- onclick="saveSettings()"/> -->
                            <span class="homey-form-checkbox-checkmark"></span>
                            <span class="homey-form-checkbox-text"><span data-i18n="tab1.broadcastDevicesChanges">Publish messages for all devices state changes</span></span>
                        </label>
                        <label class="homey-form-label" for="percentageScale" data-i18n="tab1.percentageScale">Percentage scale</label>
                        <select class="homey-form-select" id="percentageScale"> <!-- @change="saveSettings(true)"> -->
                            <option value="default" selected="selected">default (original value)</option>
                            <option value="float">float (0...1)</option>
                            <option value="int">int (0...100)</option>
                        </select>
                        <label class="homey-form-label" for="colorFormat" data-i18n="tab1.colorFormat">Color format</label>
                        <select class="homey-form-select" id="colorFormat"> <!--@change="saveSettings(true)">-->
                            <option value="hsv" selected="selected">HSV (&quot;h,s,v&quot;)</option>
                            <option value="rgb">RGB (&quot;r,g,b&quot;)</option>
                            <option value="values">Single topic per HSV value (Device capabilities)</option>
                        </select>
                    <!-- </fieldset> -->
                </div>

                <!--PROTOCOL General settings-->
                <div id="protocolGeneralSettings">
                    <label class="homey-form-label" for="capabilityName" data-i18n="tab1.capabilityName">Capability name</label>
                    <select class="homey-form-select" id="capabilityName"> <!--x @change="saveSettings(true)"> -->
                        <option value="dev_cap" selected="selected">Device name - Capability name</option>
                        <option value="cap">Capability name</option>
                    </select>
                </div>

                <!--Home Assistant -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.hass">Home Assistant Discovery</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-checkbox">
                        <input class="homey-form-checkbox-input" id="hass" type="checkbox" onClick="onInput()"/> <!-- onclick="saveSettings(true)"/> -->
                        <span class="homey-form-checkbox-checkmark"></span>
                        <span class="homey-form-checkbox-text"><span data-i18n="tab1.hass">Home Assistant Discovery (beta)</span></span>
                    </label>
                </fieldset>

                <div id="hassSettings" style="display:none">
                    <fieldset class="homey-form-fieldset">
                        <label class="homey-form-label" for="hassTopic" data-i18n="tab1.topic">Topic</label>
                        <input class="homey-form-input" id="hassTopic" type="text"> <!--onblur="saveSettings(true)">-->

                        <label class="homey-form-label" for="hassStatusTopic" data-i18n="tab1.hassStatusTopic">Status topic</label>
                        <input class="homey-form-input" id="hassStatusTopic" type="text"> <!--onblur="saveSettings()">-->

                        <label class="homey-form-label" for="hassOnlineMessage" data-i18n="tab1.hassOnlineMessage">Online message</label>
                        <input class="homey-form-input" id="hassOnlineMessage" type="text"> <!--onblur="saveSettings()">-->

                        <label class="homey-form-label" for="hassOfflineMessage" data-i18n="tab1.hassOfflineMessage">Offline message</label>
                        <input class="homey-form-input" id="hassOfflineMessage" type="text"> <!--onblur="saveSettings()">-->
                    </fieldset>
                </div>

                <!-- System State -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.systemState">System State</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-checkbox">
                        <input class="homey-form-checkbox-input" id="broadcastSystemState" type="checkbox" onClick="onInput()"/> <!--onclick="saveSettings()"/>-->
                        <span class="homey-form-checkbox-checkmark"></span>
                        <span class="homey-form-checkbox-text"><span data-i18n="tab1.broadcastSystem">Publish system state in a 30sec. interval</span></span>
                    </label>
                </fieldset>

                <div id="systemStateSettings" style="display:none">
                    <fieldset class="homey-form-fieldset">
                        <label class="homey-form-label" for="systemStateTopic" data-i18n="tab1.topic">Topic</label>
                        <input class="homey-form-input" id="systemStateTopic" type="text"> <!--onblur="saveSettings(true)">-->
                    </fieldset>
                </div>

                <!-- Commands -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.commands">Commands</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-checkbox">
                        <input class="homey-form-checkbox-input" id="commands" type="checkbox" onClick="onInput()"/> <!--onclick="saveSettings()"/>-->
                        <span class="homey-form-checkbox-checkmark"></span>
                        <span class="homey-form-checkbox-text"><span data-i18n="tab1.commandsListen">Listen to commands</span></span>
                    </label>
                </fieldset>

                <div id="commandsSettings" style="display:none">
                    <fieldset class="homey-form-fieldset">
                        <label class="homey-form-label" for="commandTopic" data-i18n="tab1.topic">Topic</label>
                        <input class="homey-form-input" id="commandTopic" type="text"> <!--onblur="saveSettings()">-->
                    </fieldset>
                </div>

                <!-- Birth & last will -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.birthWill">Birth & last will</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-checkbox">
                        <input class="homey-form-checkbox-input" id="birthWill" type="checkbox" onClick="onInput()"/> <!--onclick="saveSettings()"/>-->
                        <span class="homey-form-checkbox-checkmark"></span>
                        <span class="homey-form-checkbox-text"><span data-i18n="tab1.birthWillMessages">Send birth & last will messages</span></span>
                    </label>
                </fieldset>

                <div id="birthWillSettings" style="display:none">
                    <fieldset class="homey-form-fieldset">
                        <label class="homey-form-label" for="birthTopic" data-i18n="tab1.birthTopic">Birth topic</label>
                        <input class="homey-form-input" id="birthTopic" type="text"> <!--onblur="saveSettings()">-->

                        <label class="homey-form-label" for="birthMessage" data-i18n="tab1.birthMessage">Birth message</label>
                        <input class="homey-form-input" id="birthMessage" type="text"> <!--onblur="saveSettings()">-->

                        <label class="homey-form-label" for="willTopic" data-i18n="tab1.willTopic">Last will topic</label>
                        <input class="homey-form-input" id="willTopic" type="text"> <!--onblur="saveSettings()">-->

                        <label class="homey-form-label" for="willMessage" data-i18n="tab1.willMessage">Last will message</label>
                        <input class="homey-form-input" id="willMessage" type="text"> <!--onblur="saveSettings()">-->
                    </fieldset>
                </div>

                <!--Devices -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.devices">Devices</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-checkbox">
                        <input class="homey-form-checkbox-input" id="devicesDefaultState" type="checkbox"> <!--onclick="saveSettings()"/>-->
                        <span class="homey-form-checkbox-checkmark"></span>
                        <span class="homey-form-checkbox-text"><span data-i18n="tab1.devicesDefaultState">Set devices active by default</span></span>
                    </label>
                </fieldset>
                
                <!--Performance -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.performance">Performance</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <label class="homey-form-label" for="performanceDelay" data-i18n="tab1.performanceDelay">Send message delay</label>
                    <input class="homey-form-input" id="performanceDelay" type="text"> <!--onblur="saveSettings()">-->
                </fieldset>

                <!--Reset -->
                <header class="homey-header _homey-header">
                    <h1 class="homey-title" data-i18n="tab1.reset">Reset</h1>
                </header>
                <fieldset class="homey-form-fieldset">
                    <button class="homey-button-danger-shadow-full" id="resetButton" @click="reset()" data-i18n="tab1.restoreSettings">
                        Restore default settings
                    </button>
                </fieldset>

            </div>
            <div id="tab2" class="panel" style="display: none;">
                <div class="loader" v-if="loading">
                    <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">
                        <path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
                        <path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z">
                            <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20" dur="0.5s" repeatCount="indefinite" />
                        </path>
                    </svg>
                </div>
                <!--Device filter/sort -->
                <div id="devicesFilterSettings">
                    <div class="setting">
                        <fieldset class="homey-form-fieldset">
                            <table style="width:100%">
                                <tr>
                                    <td>                        
                                        <label class="homey-form-label" for="devicesFilterText" data-i18n="tab2.filter">Search for devices</label>
                                        <input class="homey-form-input" id="devicesFilterText" type="text" oninput="updateDevices()">
                                        <!-- <label class="settings-item-description" data-i18n="tab2.filter">Search for devices</label>
                                        <div class="settings-itemgroup">
                                            <input id="devicesFilterText" type="text" oninput="updateDevices()">
                                        </div> -->
                                    </td>
                                    <td>
                                        <label class="homey-form-label" for="colorFormat" data-i18n="tab2.sort">Sort devices</label>
                                        <select class="homey-form-select" id="deviceSort" onchange="updateDevices()">
                                            <option value="device" selected="selected">Device name</option>
                                            <option value="zone_device">Zone & Device name</option>
                                            <option value="time_adding">Time of adding</option>
                                        </select>

                                        <!-- <label class="settings-item-description" data-i18n="tab2.sort">Sort devices</label>
                                        <div class="settings-itemgroup">
                                            <select id="deviceSort" onchange="updateDevices()">
                                                <option value="device" selected="selected">Device name</option>
                                                <option value="zone_device">Zone & Device name</option>
                                                <option value="time_adding">Time of adding</option>
                                            </select>
                                        </div> -->
                                    </td>
                                </tr>
                            </table>
                        </fieldset>
                    </div>
                </div>
                <div class="rTable">
                    <!-- <div class="rTableRow devices" v-for="device in devices">

                        <div class="rTableCell line">
                            <div class="icon-cell" v-html="getIcon(device)"></div>
                        </div>
                        <div class="rTableCell line scrollable-text">
                            {{ getZone(device) }}<br />
                            <b>{{device.name}}</b>
                        </div>
                        <div class="rTableCell line settings-item-last">
                            <label class="form-switch">
                                <input type="checkbox" :checked="deviceEnabled(device)" @click="saveDevice(device, $event.target.checked)">
                                <i></i>
                            </label>
                        </div>
                    </div> -->
                    <div class="rTableRow line" v-for="device in devices">

                        <div class="rTableCell line">
                            <div class="icon-cell" v-html="getIcon(device)"></div>
                        </div>
                        <div class="rTableCell line scrollable-text">
                            {{ getZone(device) }}<br />
                            <b>{{device.name}}</b>
                        </div>
                        <div class="rTableCell line settings-item-last">
                            <label>
                                <input class="homey-form-checkbox-input" id="devicesDefaultState" type="checkbox" :checked="deviceEnabled(device)" @click="saveDevice(device, $event.target.checked)"/>
                                <span class="homey-form-checkbox-checkmark"></span>
                                <!-- <span class="homey-form-checkbox-text"><span data-i18n="tab1.devicesDefaultState">Set devices active by default</span></span> -->
                            </label>
                                    <!-- <label class="form-switch">
                                <input type="checkbox" class="homey-form-checkbox-input" :checked="deviceEnabled(device)" @click="saveDevice(device, $event.target.checked)">
                                <i></i>
                            </label> -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab3" class="panel" style="display:none;">
                <div id="instructionsen" style="display:none;">
                    <p>
                        <br />With this app you can communicate with all your devices connected to Homey. A communication channel per device will be created, so external apps can find and control each one of them.
                    </p>

                    <!-- <div class="text-header">INSTALLATION</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">INSTALLATION</h1>
                    </header>

                    <p>
                        <br />To configure the MQTT Hub you have to do the following:
                    </p>
                    <ol class="main-list">
                        <li><b>Configure an MQTT broker</b></li>
                        <ul>
                            <li>
                                The MQTT broker is the central server handling all MQTT messages.
                            </li>
                            <li>
                                Use the MQTT broker app from Homey the app store or configure an external broker (e.g. CloudMQTT, Mosquitto or HiveMQ).
                            </li>
                        </ul>
                        <li><b>Install & configure the Homey MQTT Client app</b></li>
                        <ul>
                            <li>
                                Install the MQTT Client app from the Homey app store.
                            </li>
                            <li>
                                Connect the MQTT Client to your MQTT broker.
                            </li>
                        </ul>
                        <li><b>Install the MQTT Hub (you already did) and let it discover & broadcast all your connected devices</b></li>
                        <ul>
                            <li>
                                The Hub will automatically discover all your devices.
                            </li>
                            <li>
                                The availability & state of each device will be broadcasted.
                            </li>
                        </ul>
                        <li><b>Configure the MQTT Hub</b></li>
                        <ul>
                            <li>
                                Adjust the Hub settings where needed.
                            </li>
                        </ul>
                        <li><b>Install any external application supporting MQTT</b></li>
                        <ul>
                            <li>
                                There are many applications supporting MQTT, pick one.
                            </li>
                            <li>
                                Connect your external app to the MQTT broker.
                            </li>
                            <li>
                                Let your app discover all connected devices.
                            </li>
                            <li>
                                If Homey is reported 'offline' or datatypes are not discovered correctly, try pressing the 'broadcast' button to re-start the device initialization process and be patience.
                            </li>
                            <li>
                                Configure your communication channels by observing & dispatching messages on the available MQTT topics.
                            </li>
                        </ul>
                        <li><b>Start communicating with Homey</b></li>
                        <ul>
                            <li>
                                Have fun!
                            </li>
                        </ul>
                    </ol>


                    <!-- <div class="text-header">CONFIGURATION</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">CONFIGURATION</h1>
                    </header>

                    <p>
                        <br />General MQTT Hub configuration.
                    </p>
                    <ul class="main-list">
                        <li><b>Running</b></li>
                        <ul>
                            <li>
                                Turn on/off the MQTT Hub service.
                            </li>
                        </ul>
                        <li><b>Broadcast</b></li>
                        <ul>
                            <li>
                                Press the button to force a broadcast of all available devices and their current state, so external applications can discover/update them.
                            </li>
                            <li>
                                Can be useful to (re-)discover your devices in HA, get the OpenHAB MQTT device online or update the channel datatypes if 'dummy' is displayed.
                            </li>
                        </ul>
                        <li><b>Communication protocol</b></li>
                        <ul>
                            <li>
                                Choose a default communication protocol or select 'custom' to adjust the MQTT communication to your needs.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">Homie Convention</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">Homie Convention</h1>
                    </header>

                    <p>
                        <br />Configure the communication via the Homie Convention (v3.0.1).
                    </p>
                    <ul class="main-list">
                        <li><b>Topic</b></li>
                        <ul>
                            <li>
                                The topic used to broadcast all device messages (default: homie/device name).
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">CUSTOM</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">CUSTOM</h1>
                    </header>

                    <p>
                        <br />Configure the MQTT communication to your needs.
                    </p>
                    <ul class="main-list">
                        <li><b>Topic</b></li>
                        <ul>
                            <li>
                                The topic used to broadcast all device messages.
                            </li>
                        </ul>
                        <li><b>Include device class in topic</b></li>
                        <ul>
                            <li>
                                Optionally inject the device class (e.g. light) into the MQTT topic structure.
                            </li>
                            <li>
                                This can be useful to communicate by using topic wildcards.
                            </li>
                        </ul>
                        <li><b>Include device zone in topic</b></li>
                        <ul>
                            <li>
                                Optionally inject the device zone (e.g. kitchen) into the MQTT topic structure.
                            </li>
                            <li>
                                This can be useful to communicate by using topic wildcards.
                            </li>
                        </ul>
                        <li><b>Normalize topics</b></li>
                        <ul>
                            <li>
                                Turn topic normalization on/off.
                            </li>
                            <li>
                                By Homie Convention (default) topics are all lowercase, special characters are removed, etc.
                            </li>
                        </ul>
                        <li><b>Percentage scale</b></li>
                        <ul>
                            <li>
                                The default Homey scaling for percentages is a floating point number between 0 and 1.
                            </li>
                            <li>
                                Many apps require a scaling between 0...100 (e.g. Home Assistant, gBridge, etc.).
                            </li>
                        </ul>
                        <li><b>Color format</b></li>
                        <ul>
                            <li>
                                Adjust the way color values are formatted.
                            </li>
                            <li>
                                By default a color is formatted as a HSV string "H,S,V".
                            </li>
                            <li>
                                Optionally format color values as a RGB string "R,G,B" or publish each color value on a separate channel (capabilities).
                            </li>
                        </ul>
                        <li><b>Publish device state changes</b></li>
                        <ul>
                            <li>
                                By default all device state changes (of the enabled devices) are broadcasted. This functionality can be disabled to reduce the workload.
                            </li>
                            <li>
                                When disabled your external interface will NOT be notified about device changes, but you can still communicate with the devices (i.e. set capability values).
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">HOME ASSISTANT DISCOVERY</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">HOME ASSISTANT DISCOVERY</h1>
                    </header>

                    <p>
                        <br />Discovery can be enabled to ease integration with Home Assistant. All your devices will automatically become available within HA.
                    </p>
                    <ul class="main-list">
                        <li><b>Home Assistant Discovery</b></li>
                        <ul>
                            <li>
                                Turn HA MQTT Discovery on/off (beta).
                            </li>
                            <li>
                                NOTE: This is still in beta. Not all device types are supported yet.
                            </li>
                            <li>
                                Only a sub-set of HA devices is configurable for HA MQTT Discovery.
                            </li>
                        </ul>

                        <li><b>Topic</b></li>
                        <ul>
                            <li>
                                Configure the topic on which to publish the Home Assistant configuration.
                            </li>
                        </ul>
                        <li><b>Status topic</b></li>
                        <ul>
                            <li>
                                The topic configured in Home Assistant to send 'birth' and 'last will' messages.
                            </li>
                            <li>
                                This topic is used to automatically broadcast when HA becomes online.
                            </li>
                        </ul>
                        <li><b>On-/Offline messages</b></li>
                        <ul>
                            <li>
                                The messages send by HA on the status topic.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">SYSTEM STATE</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">SYSTEM STATE</h1>
                    </header>

                    <p>
                        <br />The system state broadcaster publishes the current state (CPU, memory, workload, etc.) of your Homey in a regular interval of 30 sec.
                    </p>
                    <ul class="main-list">
                        <li><b>Dispatch system state</b></li>
                        <ul>
                            <li>
                                Turn the system state dispatcher on/off.
                            </li>
                        </ul>

                        <li><b>Topic</b></li>
                        <ul>
                            <li>
                                Configure the topic on which to publish the system state.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">COMMANDS</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">COMMANDS</h1>
                    </header>

                    <p>
                        <br />Control your Homey by sending commands to the command topic.
                    </p>
                    <ul class="main-list">
                        <li><b>Commands (alpha)</b></li>
                        <ul>
                            <li>
                                Turn the commands listener on/off.
                            </li>
                            <li>
                                Commands are an advanced way to communicate with Homey over MQTT.
                            </li>
                            <li>
                                See the app README for details.
                            </li>
                        </ul>

                        <li><b>Topic</b></li>
                        <ul>
                            <li>
                                Configure the topic on which to listen for commands.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">BIRTH & LAST WILL</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">BIRTH & LAST WILL</h1>
                    </header>

                    <p>
                        <br />Broadcast a 'birth' message on MQTT Hub startup and a 'last will' message on shutdown.
                    </p>
                    <ul class="main-list">
                        <li><b>Send birth & last will messages</b></li>
                        <ul>
                            <li>
                                Turn the messages on/off.
                            </li>
                        </ul>

                        <li><b>Topics</b></li>
                        <ul>
                            <li>
                                Configure the topics on which to publish the birth and last will messages.
                            </li>
                        </ul>
                        <li><b>Messages</b></li>
                        <ul>
                            <li>
                                Configure the payload for the birth and last will messages.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">RESET</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">RESET</h1>
                    </header>

                    <p>
                        <br />Reset all settings.
                    </p>
                    <ul class="main-list">
                        <li><b>Restore default settings</b></li>
                        <ul>
                            <li>
                                Load app defaults.
                            </li>
                            <li>
                                All settings will be reset, including device configuration.
                            </li>
                        </ul>
                    </ul>

                    <!-- <div class="text-header">DEVICES</div> -->
                    <header class="homey-header _homey-header">
                        <h1 class="homey-title">DEVICES</h1>
                    </header>

                    <p>
                        <br />Configure which devices are included in the MQTT Hub.
                    </p>
                    <ul class="main-list">
                        <li>
                            Enable/disable each device individually.
                        </li>
                        <li>
                            When a device is <b>disabled</b>, it is fully excluded from the Hub. So all communication is disabled and no device state changes will be broadcasted for this device.
                        </li>
                    </ul>
                </div>
                <div id="instructionsnl" style="display:none">
                    <!--To be implemented-->
                </div>
            </div>


            <div id="tab4" class="panel" style="display: none;">
                <div class="setting">
                    <label class="loglevel" data-i18n="tab4.loglevel">Log level</label>
                    <div class="settings-itemgroup">
                        <select class="homey-form-select" id="loglevel" @change="setLogLevel($event.target.value)">
                            <option value="off">Turned off</option>
                            <option value="error">Errors and Warnings</option>
                            <option value="info" selected="selected">Information</option>
                            <option value="debug">Debug</option>
                        </select>
                        <!-- <select id="loglevel" @change="setLogLevel($event.target.value)">
                            <option value="off">Turned off</option>
                            <option value="error">Errors and Warnings</option>
                            <option value="info" selected="selected">Information</option>
                            <option value="debug">Debug</option>
                        </select> -->
                    </div>
                </div>
                <div v-html="log"></div>
            </div>

        </div>
        
    </div>
</body>
</html>